!function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=48)}([function(t,e){t.exports=React},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,n){var r=n(22),a=n(1);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?a(t):e}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e,n){var r=n(23);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){var r=n(2);t.exports=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){r(t,e,n[e])})}return t}},function(t,e,n){t.exports=n(27)},function(t,e){t.exports=ReactRouterDOM},function(t,e,n){"use strict";function r(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,n=[],r=0;r<36;r++)n[r]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return n[14]="4",n[19]="0123456789abcdef".substr(3&n[19]|8,1),n[8]=n[13]=n[18]=n[23]=t,n.join("").substr(0,e)}function a(t,e){return!e||new RegExp(e,"i").test(t)}n.d(e,"b",function(){return r}),n.d(e,"a",function(){return a})},function(t,e){function n(t,e,n,r,a,o,i){try{var c=t[o](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,a)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise(function(a,o){var i=t.apply(e,r);function c(t){n(i,a,o,c,u,"next",t)}function u(t){n(i,a,o,c,u,"throw",t)}c(void 0)})}}},function(t,e,n){var r=n(38),a=n(39),o=n(40);t.exports=function(t){return r(t)||a(t)||o()}},function(t,e){t.exports=d3},function(t,e){t.exports=ReactDOM},function(t,e){function n(){return t.exports=n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},n.apply(this,arguments)}t.exports=n},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return CLOCK}),__webpack_require__.d(__webpack_exports__,"b",function(){return Cell});var _babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(13),_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8),_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(4),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4__),lib_common__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(11),CLOCK=Symbol("系统时钟"),Cell=function(){function Cell(t){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_3___default()(this,Cell),this.clock=0,t.from?this.initByFullConfig(t):this.initBySimpleConfig(t)}return _babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_4___default()(Cell,[{key:"initByFullConfig",value:function(t){var e=t.components[t.from];this.id=t.id||Object(lib_common__WEBPACK_IMPORTED_MODULE_5__.b)(),this.input=t.input||[],this.out=e.output,this.component=e.component,this.assignInfo(this,e),this.body=e.links.map(function(e){var n=t.components[e.component];if("COMPONENT"===n.type){var r=n.input.reduce(function(t,n,r){return t[n]=e.input[r],t},{});return new Cell({components:_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_2___default()({},t.components,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_1___default()({},e.component,_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_2___default()({},n,{component:e.component,input:e.input,x:e.x,y:e.y,links:n.links.map(function(t){return _babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_2___default()({},t,{input:t.input.map(function(t,e){return r[t]||t})})})}))),id:e.id,input:e.input,output:n.output,from:e.component})}return new Cell(_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_2___default()({},e,n))})}},{key:"initBySimpleConfig",value:function initBySimpleConfig(config){this.id=config.id||Object(lib_common__WEBPACK_IMPORTED_MODULE_5__.b)(),this.input=config.input||[],this.component=config.component,this.assignInfo(this,config),eval("this.body = ".concat(config.body))}},{key:"assignInfo",value:function(t,e){t.type=e.type,t.name=e.name,t.desc=e.desc,t.x=e.x,t.y=e.y}},{key:"reset",value:function(){this.clock=0,this.lastData=void 0,this.innerClock=void 0,"COMPONENT"===this.type&&this.body.map(function(t){return t.reset()})}},{key:"setFunc",value:function setFunc(func){eval("this.body = ".concat(func))}},{key:"addInput",value:function(t){this.input.push(t)}},{key:"removeInput",value:function(t){this.input.splice(t,1)}},{key:"toJson",value:function(){var t={};return this.getComponents(t),{from:this.id,components:t}}},{key:"getComponents",value:function(t){(t=t||{})[this.component||this.id]||("COMPONENT"===this.type?(t[this.component||this.id]={input:this.input,output:this.out,type:this.type,name:this.name,desc:this.desc,links:this.body.map(function(t){return{id:t.id,input:t.input,component:t.component,x:t.x,y:t.y}})},this.body.map(function(e){e.getComponents(t)})):t[this.component]={type:this.type,name:this.name,desc:this.desc,body:this.body&&this.body.toString()})}},{key:"calc",value:function(t){for(var e=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var o=this.body.find(function(e){return e.id===t});if(!o)return r[this.input.findIndex(function(e){return e===t})];if(o.innerClock>=window[CLOCK])return o.lastData;o.innerClock=window[CLOCK];var i=o.input.map(function(t){return e.calc.apply(e,[t].concat(r))});return o.output.apply(o,_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(i))}},{key:"output",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.clock>=window[CLOCK])return log("[反馈]","".concat(this.name,"(").concat(e,") = ").concat(this.lastData)),this.lastData;if(this.clock++,"COMPONENT"===this.type)return this.lastData=this.calc.apply(this,[this.out].concat(e)),log("[组件]","".concat(this.name,"(").concat(e,") = ").concat(this.lastData)),this.lastData;if("VIEW"===this.type)return[this.clock].concat(_babel_runtime_helpers_toConsumableArray__WEBPACK_IMPORTED_MODULE_0___default()(e.map(function(t){return t.lastData})));var r=this.body.bind({clock:window[CLOCK]});return this.lastData=r.apply(void 0,e),log("[函数]","".concat(this.name,"(").concat(e,") = ").concat(this.lastData)),this.lastData}}]),Cell}()},function(t,e,n){var r=n(24),a=n(25),o=n(26);t.exports=function(t,e){return r(t)||a(t,e)||o()}},function(t,e,n){var r=n(34);t.exports=function(t,e){if(null==t)return{};var n,a,o=r(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}},function(t,e){t.exports=antd},function(t,e,n){var r=n(29),a=Object.prototype.hasOwnProperty,o=Array.prototype.splice,i=Object.prototype.toString,c=function(t){return i.call(t).slice(8,-1)},u=Object.assign||function(t,e){return l(e).forEach(function(n){a.call(e,n)&&(t[n]=e[n])}),t},l="function"==typeof Object.getOwnPropertySymbols?function(t){return Object.keys(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.keys(t)};function s(t){if(Array.isArray(t))return u(t.constructor(t.length),t);if("Map"===c(t))return new Map(t);if("Set"===c(t))return new Set(t);if(t&&"object"==typeof t){var e=Object.getPrototypeOf(t);return u(Object.create(e),t)}return t}function p(){var t=u({},f);return e.extend=function(e,n){t[e]=n},e.isEquals=function(t,e){return t===e},e;function e(n,o){"function"==typeof o&&(o={$apply:o}),Array.isArray(n)&&Array.isArray(o)||r(!Array.isArray(o),"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."),r("object"==typeof o&&null!==o,"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the following commands: %s.",Object.keys(t).join(", "));var i=n;return l(o).forEach(function(r){if(a.call(t,r)){var u=n===i;i=t[r](o[r],i,o,n),u&&e.isEquals(i,n)&&(i=n)}else{var l="Map"===c(n)?e(n.get(r),o[r]):e(n[r],o[r]),p="Map"===c(i)?i.get(r):i[r];e.isEquals(l,p)&&(void 0!==l||a.call(n,r))||(i===n&&(i=s(n)),"Map"===c(i)?i.set(r,l):i[r]=l)}}),i}}var f={$push:function(t,e,n){return d(e,n,"$push"),t.length?e.concat(t):e},$unshift:function(t,e,n){return d(e,n,"$unshift"),t.length?t.concat(e):e},$splice:function(t,e,n,a){return function(t,e){r(Array.isArray(t),"Expected $splice target to be an array; got %s",t),y(e.$splice)}(e,n),t.forEach(function(t){y(t),e===a&&t.length&&(e=s(a)),o.apply(e,t)}),e},$set:function(t,e,n){return function(t){r(1===Object.keys(t).length,"Cannot have more than one key in an object with $set")}(n),t},$toggle:function(t,e){m(t,"$toggle");var n=t.length?s(e):e;return t.forEach(function(t){n[t]=!e[t]}),n},$unset:function(t,e,n,r){return m(t,"$unset"),t.forEach(function(t){Object.hasOwnProperty.call(e,t)&&(e===r&&(e=s(r)),delete e[t])}),e},$add:function(t,e,n,r){return _(e,"$add"),m(t,"$add"),"Map"===c(e)?t.forEach(function(t){var n=t[0],a=t[1];e===r&&e.get(n)!==a&&(e=s(r)),e.set(n,a)}):t.forEach(function(t){e!==r||e.has(t)||(e=s(r)),e.add(t)}),e},$remove:function(t,e,n,r){return _(e,"$remove"),m(t,"$remove"),t.forEach(function(t){e===r&&e.has(t)&&(e=s(r)),e.delete(t)}),e},$merge:function(t,e,n,a){return function(t,e){r(e&&"object"==typeof e,"update(): $merge expects a spec of type 'object'; got %s",e),r(t&&"object"==typeof t,"update(): $merge expects a target of type 'object'; got %s",t)}(e,t),l(t).forEach(function(n){t[n]!==e[n]&&(e===a&&(e=s(a)),e[n]=t[n])}),e},$apply:function(t,e){return function(t){r("function"==typeof t,"update(): expected spec of $apply to be a function; got %s.",t)}(t),t(e)}},h=p();function d(t,e,n){r(Array.isArray(t),"update(): expected target of %s to be an array; got %s.",n,t),m(e[n],n)}function m(t,e){r(Array.isArray(t),"update(): expected spec of %s to be an array; got %s. Did you forget to wrap your parameter in an array?",e,t)}function y(t){r(Array.isArray(t),"update(): expected spec of $splice to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",t)}function _(t,e){var n=c(t);r("Map"===n||"Set"===n,"update(): %s expects a target of type Set or Map; got %s",e,n)}t.exports=h,t.exports.default=h,t.exports.newContext=p},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=r=function(t){return n(t)}:t.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},r(e)}t.exports=r},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=t[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){a=!0,o=t}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(t,e,n){var r=function(){return this||"object"==typeof self&&self}()||Function("return this")(),a=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=a&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,t.exports=n(28),a)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(t){r.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";var n,r=Object.prototype,a=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",l="object"==typeof t,s=e.regeneratorRuntime;if(s)l&&(t.exports=s);else{(s=e.regeneratorRuntime=l?t.exports:{}).wrap=b;var p="suspendedStart",f="suspendedYield",h="executing",d="completed",m={},y={};y[i]=function(){return this};var _=Object.getPrototypeOf,v=_&&_(_(M([])));v&&v!==r&&a.call(v,i)&&(y=v);var g=O.prototype=x.prototype=Object.create(y);w.prototype=g.constructor=O,O.constructor=w,O[u]=w.displayName="GeneratorFunction",s.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},s.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,O):(t.__proto__=O,u in t||(t[u]="GeneratorFunction")),t.prototype=Object.create(g),t},s.awrap=function(t){return{__await:t}},k(C.prototype),C.prototype[c]=function(){return this},s.AsyncIterator=C,s.async=function(t,e,n,r){var a=new C(b(t,e,n,r));return s.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},k(g),g[u]="Generator",g[i]=function(){return this},g.toString=function(){return"[object Generator]"},s.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},s.values=M,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,a){return c.type="throw",c.arg=t,e.next=r,a&&(e.method="next",e.arg=n),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=a.call(i,"catchLoc"),l=a.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;j(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:M(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),m}}}function b(t,e,n,r){var a=e&&e.prototype instanceof x?e:x,o=Object.create(a.prototype),i=new N(r||[]);return o._invoke=function(t,e,n){var r=p;return function(a,o){if(r===h)throw new Error("Generator is already running");if(r===d){if("throw"===a)throw o;return L()}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var c=P(i,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===p)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var u=E(t,e,n);if("normal"===u.type){if(r=n.done?d:f,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=d,n.method="throw",n.arg=u.arg)}}}(t,n,i),o}function E(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function x(){}function w(){}function O(){}function k(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function C(t){var e;this._invoke=function(n,r){function o(){return new Promise(function(e,o){!function e(n,r,o,i){var c=E(t[n],t,r);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==typeof l&&a.call(l,"__await")?Promise.resolve(l.__await).then(function(t){e("next",t,o,i)},function(t){e("throw",t,o,i)}):Promise.resolve(l).then(function(t){u.value=t,o(u)},function(t){return e("throw",t,o,i)})}i(c.arg)}(n,r,e,o)})}return e=e?e.then(o,o):o()}}function P(t,e){var r=t.iterator[e.method];if(r===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,P(t,e),"throw"===e.method))return m;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=E(r,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,m;var o=a.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,m):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,m)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function M(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(a.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:n,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},function(t,e,n){"use strict";t.exports=function(t,e,n,r,a,o,i,c){if(!t){var u;if(void 0===e)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,a,o,i,c],s=0;(u=new Error(e.replace(/%s/g,function(){return l[s++]}))).name="Invariant Violation"}throw u.framesToPop=1,u}}},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e){t.exports=function(t,e){if(null==t)return{};var n,r,a={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e){t.exports=function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}},function(t,e){t.exports=function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"project",function(){return M}),n.d(r,"component",function(){return L});var a=n(4),o=n.n(a),i=n(3),c=n.n(i),u=n(5),l=n.n(u),s=n(6),p=n.n(s),f=n(7),h=n.n(f),d=n(0),m=n.n(d),y=n(15),_=n.n(y),v=n(10),g=n(18),b=n.n(g),E=n(9),x=n.n(E),w=n(8),O=n.n(w),k=n(12),C=n.n(k),P=n(11),D=n(21),j=n.n(D),N=function(){function t(e){o()(this,t),this.table=e;var n=localStorage[e];n||(localStorage[e]=JSON.stringify([]),n=localStorage[e]),this.data=JSON.parse(n)}return c()(t,[{key:"add",value:function(){var t=C()(x.a.mark(function t(e){return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=O()({},e,{_id:e._id||Object(P.b)()}),this.data.push(e),localStorage[this.table]=JSON.stringify(this.data),t.abrupt("return",e._id);case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"remove",value:function(){var t=C()(x.a.mark(function t(e){return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.data=this.data.filter(function(t){return t._id!==e}),localStorage[this.table]=JSON.stringify(this.data);case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"update",value:function(){var t=C()(x.a.mark(function t(e,n){return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.data=this.data.map(function(t){return Object.entries(e).every(function(e){var n=b()(e,2),r=n[0],a=n[1];return t[r]===a})?j()(t,n):t}),localStorage[this.table]=JSON.stringify(this.data);case 2:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()},{key:"find",value:function(){var t=C()(x.a.mark(function t(e){return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=2;break}return t.abrupt("return",this.data.filter(function(t){return Object.entries(e).every(function(e){var n=b()(e,2),r=n[0],a=n[1];return t[r]===a})}));case 2:return t.abrupt("return",this.data);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"findOne",value:function(){var t=C()(x.a.mark(function t(e){return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.find(e).then(function(t){return t[0]});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}]),t}(),M=new N("project"),L=new N("component"),A=(n(30),function(t){function e(t){return o()(this,e),l()(this,p()(e).call(this,t))}return h()(e,t),c()(e,[{key:"render",value:function(){return m.a.createElement("div",{className:"home"},m.a.createElement("h2",null,"INFINITY"),m.a.createElement("p",null,"这是一个编辑器"),m.a.createElement("p",null,m.a.createElement(v.NavLink,{to:"/project"},"开始 >")))}}]),e}(d.Component)),S=n(1),I=n.n(S),T=n(2),R=n.n(T),B=n(20),U=(n(31),function(t){function e(t){return o()(this,e),l()(this,p()(e).call(this,t))}return h()(e,t),c()(e,[{key:"render",value:function(){var t=this.props,e=t.ratio,n=t.children;return m.a.createElement("div",{className:"card"},m.a.createElement("div",{className:"bg",style:{paddingBottom:"".concat(100*e,"%")}}," "),m.a.createElement("div",{className:"container"},n))}}]),e}(d.Component));R()(U,"defaultProps",{ratio:.618});var K=n(16),W=n.n(K),$=(n(32),function(t){function e(t){return o()(this,e),l()(this,p()(e).call(this,t))}return h()(e,t),c()(e,[{key:"render",value:function(){var t=W()({},this.props);return"textarea"===t.type?m.a.createElement("textarea",W()({rows:"3"},t,{className:"infinity-input infinity-focus ".concat(t.className||"")})):m.a.createElement("input",W()({autocomplete:"off"},t,{className:"infinity-input infinity-focus ".concat(t.className||"")}))}}]),e}(d.Component)),q=(n(33),function(t){function e(t){var n;return o()(this,e),n=l()(this,p()(e).call(this,t)),R()(I()(I()(n)),"handleChange",function(t,e){n.data[e]=t.target.value,n.invalid[e]!==!t.target.checkValidity()&&(n.invalid[e]=!t.target.checkValidity(),n.forceUpdate()),n.props.onChange&&n.props.onChange(n.data,n.invalid)}),n.data={},n.invalid={},m.a.Children.map(t.children,function(t){t.props.name&&(n.data[t.props.name]=void 0!==t.value?t.value:t.defaultValue)}),n}return h()(e,t),c()(e,[{key:"render",value:function(){var t=this,e=this.props.children;return m.a.createElement("form",null,m.a.Children.map(e,function(e){var n=e.props,r=n.name,a=n.className;return O()({},e,{props:O()({},e.props,{className:t.invalid[r]?"infinity-err ".concat(a):a,onChange:function(e){t.handleChange(e,r)}})})}))}}]),e}(d.Component)),F=n(19),V=n.n(F),Y=(n(35),function(t){function e(t){return o()(this,e),l()(this,p()(e).call(this,t))}return h()(e,t),c()(e,[{key:"render",value:function(){var t=this.props,e=t.children,n=V()(t,["children"]);return m.a.createElement("button",W()({},n,{className:"infinity-btn infinity-hover ".concat(n.className||"")}),e)}}]),e}(d.Component)),J=(n(36),function(t){function e(t){var n;return o()(this,e),n=l()(this,p()(e).call(this,t)),R()(I()(I()(n)),"handleCancel",function(){n.props.onCancel&&n.props.onCancel()}),R()(I()(I()(n)),"handleOk",function(){n.props.onOk&&n.props.onOk()}),R()(I()(I()(n)),"clearEvent",function(t){t.preventDefault(),t.stopPropagation()}),n}return h()(e,t),c()(e,null,[{key:"open",value:function(t){var n=document.createElement("div");function r(){document.getElementById("app").style.filter="none",_.a.unmountComponentAtNode(n)&&n.parentNode&&(t.onCancel&&t.onCancel.apply(t,arguments),n.parentNode.removeChild(n))}document.body.appendChild(n),document.getElementById("app").style.filter="blur(10px)";var a=t.content,o=V()(t,["content"]);return _.a.render(m.a.createElement(e,W()({},o,{onCancel:r}),a),n),{close:r}}}]),c()(e,[{key:"render",value:function(){var t=this.props,e=t.children,n=t.width,r=t.height,a=t.title,o=t.className;return m.a.createElement("div",{className:"modal ".concat(o||""),onClick:this.handleCancel},m.a.createElement("div",{className:"modal-container",onClick:this.clearEvent,style:{width:n,height:r}},m.a.createElement("div",{className:"modal-header"},m.a.createElement("h2",{className:"modal-title"},a),m.a.createElement("a",{className:"modal-close infinity-hover",onClick:this.handleCancel},m.a.createElement("i",{className:"iconfont icon-delete"}))),m.a.createElement("div",{className:"modal-content"},e),m.a.createElement("div",{className:"modal-footer"},m.a.createElement(Y,{onClick:this.handleOk},"确定"),m.a.createElement(Y,{onClick:this.handleCancel},"取消"))))}}]),e}(d.Component));function X(t){var e=this;return J.open(O()({},t,{content:React.createElement(q,{onChange:function(t,n){e.data=t,e.invalid=n}},t.content),onOk:function(){Object.values(e.invalid).find(function(t){return t})||t.onOk&&t.onOk(e.data)}}))}function G(t){var e=J.open(O()({},t,{onOk:function(){t.onOk&&t.onOk(),e.close()}}))}R()(J,"defaultProps",{title:"Modal",width:320});n(37);var H=function(t){function e(t){var n;return o()(this,e),n=l()(this,p()(e).call(this,t)),R()(I()(I()(n)),"update",function(){API.project.find().then(function(t){n.setState({projects:t})})}),R()(I()(I()(n)),"handleCreateModal",function(){n.modalCreate=new X({title:"创建项目",content:[m.a.createElement($,{name:"name",required:!0,placeholder:"名称",style:{marginBottom:15}}),m.a.createElement($,{name:"desc",type:"textarea",placeholder:"简介"})],onOk:function(t){n.create(t)}})}),R()(I()(I()(n)),"create",function(){var t=C()(x.a.mark(function t(e){var r,a,o,i;return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(P.b)(),t.next=3,API.project.add({name:e.name,desc:e.desc,config:{from:r,components:R()({},r,{type:"COMPONENT",name:e.name,desc:e.desc,input:[],links:[]})}});case 3:a=t.sent,o=n.props,i=o.match,o.history.push("".concat(i.path,"/").concat(a)),n.modalCreate.close(),n.modalCreate=null;case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()),R()(I()(I()(n)),"handleRemove",function(t){var e=n.state.projects.find(function(e){return e._id===t});G({title:"删除项目",content:'确定删除"'.concat(e.name,'"吗?'),onOk:function(){API.project.remove(t).then(function(){n.setState({projects:n.state.projects.filter(function(e){return e._id!==t})})})}})}),R()(I()(I()(n)),"handleSearch",function(t){n.setState({query:t.target.value})}),n.state={projects:[],query:""},n}return h()(e,t),c()(e,[{key:"componentDidMount",value:function(){this.update()}},{key:"render",value:function(){var t=this,e=this.props.match,n=this.state,r=n.projects,a=n.query;return m.a.createElement("div",{className:"project-list"},m.a.createElement("div",{className:"search-bar"},m.a.createElement("input",{onChange:this.handleSearch,type:"text",placeholder:"请输入要搜索的内容"}),m.a.createElement("a",{className:"search-btn"},m.a.createElement("i",{className:"iconfont icon-search"}))),m.a.createElement(B.Row,{gutter:16},m.a.createElement(B.Col,{xs:12,sm:8,md:6,lg:6,xl:4},m.a.createElement(U,null,m.a.createElement("a",{className:"project-list-item",onClick:this.handleCreateModal},m.a.createElement("i",{className:"iconfont icon-new"})))),r.filter(function(t){return Object(P.a)(t.name,a)}).map(function(n,r){return m.a.createElement(B.Col,{key:n._id,xs:12,sm:8,md:6,lg:6,xl:4},m.a.createElement(U,null,m.a.createElement(v.NavLink,{className:"project-list-item",to:"".concat(e.path,"/").concat(n._id)},m.a.createElement("i",{className:"iconfont icon-component"}),m.a.createElement("div",{className:"info"},m.a.createElement("h2",null,n.name),m.a.createElement("p",null,n.desc))),m.a.createElement("a",{className:"delete",onClick:function(){return t.handleRemove(n._id)}},m.a.createElement("i",{className:"iconfont icon-delete"}))))})))}}]),e}(d.Component),z=n(13),Q=n.n(z),Z=(n(41),function(t){function e(t){var n;return o()(this,e),n=l()(this,p()(e).call(this,t)),R()(I()(I()(n)),"handleClick",function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),a=1;a<e;a++)r[a-1]=arguments[a];t&&t.apply(void 0,r),n.props.onBlur()}),n}return h()(e,t),c()(e,[{key:"componentDidMount",value:function(){this.refs.menu.focus()}},{key:"render",value:function(){var t=this,e=this.props,n=e.data,r=e.onBlur;return m.a.createElement("div",{className:"context-menu"},m.a.createElement("ul",{tabindex:"1",ref:"menu",onBlur:r},n.map(function(e,n){return m.a.createElement("li",{key:n,onClick:function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t.handleClick.apply(t,[e.onClick].concat(r))}},e.name)})))}}]),e}(d.Component)),tt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){return O()({},n,{props:O()({},n.props,{onDragEnter:function(t){t.preventDefault()},onDragOver:function(t){t.preventDefault()},onDrop:function(n){n.preventDefault();var r=function(t){return JSON.parse(t.dataTransfer.getData("text"))}(n);-1!==t.indexOf(r.type)&&e.onDrop&&e.onDrop(r,n)}})})}},et=function(t,e){return function(n){return O()({},n,{props:O()({},n.props,{draggable:!0,onDragStart:function(n){n.dataTransfer.setData("text",JSON.stringify({type:t,data:e}))}})})}},nt=n(17),rt=(n(42),function(t){function e(t){var n;return o()(this,e),(n=l()(this,p()(e).call(this,t))).rect={x:t.x,y:t.y},n}return h()(e,t),c()(e,[{key:"render",value:function(){var t=this.props.children,e=this.rect,n=e.x,r=e.y;return m.a.createElement("div",{className:"popover",style:{left:n,top:r}},t)}}]),e}(d.Component));R()(rt,"defaultProps",{x:0,y:0});var at=function(t){var e=document.createElement("div");function n(){_.a.unmountComponentAtNode(e)&&e.parentNode&&e.parentNode.removeChild(e),t.onCancel&&t.onCancel.apply(t,arguments)}document.body.appendChild(e);var r=O()({},t.content,{props:O()({},t.content.props,{onBlur:n})});return _.a.render(m.a.createElement(rt,{x:t.x,y:t.y},r),e),{destroy:n}},ot=(n(43),function(t){function e(t){var n;return o()(this,e),n=l()(this,p()(e).call(this,t)),R()(I()(I()(n)),"mount",function(t){n.editor=ace.edit(t),n.editor.setTheme("ace/theme/monokai"),n.editor.session.setMode("ace/mode/javascript")}),R()(I()(I()(n)),"getValue",function(){return n.editor.getValue()}),n}return h()(e,t),c()(e,[{key:"render",value:function(){return m.a.createElement("div",{className:"editor",onClick:function(t){t.stopPropagation(),t.preventDefault()}},m.a.createElement("div",{ref:this.mount,style:{width:"100%",height:"100%"}},this.props.children))}}]),e}(d.Component)),it=function(){function t(e){var n=this,r=e.dom,a=e.onDrag,i=e.onDragEnd;o()(this,t),R()(this,"dragStart",function(t){n.lx=t.pageX,n.ly=t.pageY,window.addEventListener("mousemove",n.drag),window.addEventListener("mouseup",n.dragEnd)}),R()(this,"dragEnd",function(t){window.removeEventListener("mousemove",n.drag),window.removeEventListener("mouseup",n.dragEnd),n.cb(t,n.onDragEnd)}),R()(this,"drag",function(t){n.cb(t,n.onDrag)}),this.onDrag=a,this.onDragEnd=i,r.addEventListener("mousedown",this.dragStart)}return c()(t,[{key:"cb",value:function(t,e){if(e){var n=t.pageX-this.lx,r=t.pageY-this.ly;this.lx=t.pageX,this.ly=t.pageY,e(n,r)}}}]),t}(),ct=(n(44),function(t){function e(t){return o()(this,e),l()(this,p()(e).call(this,t))}return h()(e,t),c()(e,[{key:"componentDidMount",value:function(){var t=this;new it({dom:this.dragHandler,onDrag:function(e,n){t.props.onDrag&&t.props.onDrag(e,n)},onDragEnd:function(e,n){t.props.onDragEnd&&t.props.onDragEnd(e,n)}})}},{key:"render",value:function(){var t=this,e=this.props,n=e.module,r=e.onLink,a=e.onEdit,o=e.onContextMenu;return m.a.createElement("g",{className:"brick",transform:"translate(".concat(n.x-25,", ").concat(n.y-25,")")},m.a.createElement("g",{ref:function(e){return t.dragHandler=e},onContextMenu:o},m.a.createElement("rect",{width:50,height:50}),m.a.createElement("text",{x:25,y:25,onDoubleClick:a},n.name),m.a.createElement("text",{className:"output",x:62,y:37},n.lastData&&n.lastData.toFixed(2))),m.a.createElement("g",{className:"io-area",onClick:function(){return r&&r(n)}},m.a.createElement("rect",{x:0,y:0,width:50,height:5}),m.a.createElement("rect",{x:45,y:0,width:5,height:50}),m.a.createElement("rect",{x:0,y:45,width:50,height:5}),m.a.createElement("rect",{x:0,y:0,width:5,height:50})))}}]),e}(d.Component)),ut=n(14),lt=(n(45),function(t){function e(t){var n;return o()(this,e),n=l()(this,p()(e).call(this,t)),R()(I()(I()(n)),"customXAxis",function(t){t.call(n.xAxis),t.selectAll(".tick line").attr("stroke","#777").attr("stroke-dasharray","2,2"),t.selectAll(".tick text").attr("dy",-10).attr("dx",8)}),R()(I()(I()(n)),"customYAxis",function(t){t.call(n.yAxis),t.selectAll(".tick line").attr("stroke","#777").attr("stroke-dasharray","2,2"),t.selectAll(".tick text").attr("x",4).attr("dy",-4)}),n}return h()(e,t),c()(e,[{key:"componentDidMount",value:function(){var t=this.props.data,e=this.refs.container,n=e.clientWidth,r=e.clientHeight;this.svg=ut.select(this.refs.svg),this.x=ut.scaleLinear().range([0,n]),this.y=ut.scaleLinear().range([r,0]),this.xAxis=ut.axisBottom(this.x).tickSize(r),this.yAxis=ut.axisRight(this.y).tickSize(n).ticks(5),this.update(t),this.svg.append("g").attr("class","axis axis-x").attr("transform","translate(0, 0)").call(this.customXAxis),this.svg.append("g").attr("class","axis axis-y").call(this.customYAxis)}},{key:"componentWillReceiveProps",value:function(t){t.data!==this.props.data&&this.update(t.data)}},{key:"update",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=this.props.xCount,r=void 0===n?30:n;e=e.length<r?Q()(e).concat(Q()(Array(r-e.length).fill(0).map(function(t,n){return[n+e.length,0]}))):e.slice(-r-1),this.x.domain(ut.extent(e,function(t){return t[0]}));var a=ut.extent(e,function(t){return t[1]}),o=.1*(a[1]-a[0]);a=[a[0]-o,a[1]+o],this.y.domain(a),this.line=ut.line().x(function(e){return t.x(e[0])}).y(function(e){return t.y(e[1])}),this.g&&this.g.remove(),this.g=this.svg.append("g"),this.g.append("path").datum(e).attr("class","line").attr("d",this.line),this.svg.select(".axis-x").call(this.customXAxis),this.svg.select(".axis-y").call(this.customYAxis)}},{key:"render",value:function(){return m.a.createElement("div",{className:"osc",ref:"container"},m.a.createElement("svg",{ref:"svg"}))}}]),e}(d.Component)),st=(n(46),function(t){function e(t){var n;return o()(this,e),n=l()(this,p()(e).call(this,t)),R()(I()(I()(n)),"update",C()(x.a.mark(function t(){var e,r,a;return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.props.match.params.id,t.next=3,API.project.findOne({_id:e});case 3:return r=t.sent,t.next=6,API.component.find();case 6:a=t.sent,n.publicComponents=a.filter(function(t){return t._id!==e}),n.project=r,n.cell=new nt.b(r.config),n.forceUpdate();case 11:case"end":return t.stop()}},t,this)}))),R()(I()(I()(n)),"handleDrop",function(){var t=C()(x.a.mark(function t(e,r){var a,o,i,c;return x.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.target.getBoundingClientRect(),o=r.pageX-a.x,i=r.pageY-a.y,"COMPONENT"!==e.type){t.next=9;break}return c=n.project.config.components,t.next=7,n.cell.body.push(new nt.b({components:O()({},c,R()({},e.data.id,O()({},c[e.data.id],{component:e.data.id,x:o,y:i}))),from:e.data.id}));case 7:t.next=17;break;case 9:if("FUNCTION"!==e.type){t.next=14;break}return t.next=12,n.cell.body.push(new nt.b({id:Object(P.b)(),input:[],component:Object(P.b)(),type:e.type,name:"ƒ(x)",x:o,y:i}));case 12:t.next=17;break;case 14:if("VIEW"!==e.type){t.next=17;break}return t.next=17,n.cell.body.push(new nt.b({id:Object(P.b)(),input:[],component:Object(P.b)(),type:e.type,name:"V(x)",x:o,y:i}));case 17:n.forceUpdate();case 18:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}()),R()(I()(I()(n)),"handleDrag",function(t,e,r){t.x+=e,t.y+=r,n.forceUpdate()}),R()(I()(I()(n)),"handleDragEnd",function(t){}),R()(I()(I()(n)),"handleLink",function(t){if(n.currentInput){n.cell.body.findIndex(function(e){return e.id===t.id});t.addInput(n.currentInput.id),n.clearTmpLink()}else"VIEW"!==t.type&&(n.currentInput=t,n.tmpPath=document.createElementNS("http://www.w3.org/2000/svg","path"),n.tmpPath.setAttribute("class","path-display"),n.refs.lines.appendChild(n.tmpPath),n.linkAnimate=function(e){var r=n.refs.content.getBoundingClientRect();n.tmpPath.setAttribute("d",n.pathData(t,{x:e.pageX-r.x,y:e.pageY-r.y,width:0,height:0}))},n.handleKeyPress=function(t){t.stopPropagation(),t.preventDefault(),n.clearTmpLink()},window.addEventListener("mousemove",n.linkAnimate),window.addEventListener("contextmenu",n.handleKeyPress))}),R()(I()(I()(n)),"clearTmpLink",function(){n.currentInput=null,window.removeEventListener("mousemove",n.linkAnimate),window.removeEventListener("contextmenu",n.handleKeyPress),n.linkAnimate=null,n.handleKeyPress=null,n.refs.lines.removeChild(n.tmpPath),n.tmpPath=null,n.forceUpdate()}),R()(I()(I()(n)),"handleEdit",function(t){var e=new ot({children:t.body&&t.body.toString()}),n=J.open({className:"modal-editor",width:"80%",height:"80%",content:e.render(),onOk:function(){var r=e.getValue();t.setFunc(r),n.close()}})}),R()(I()(I()(n)),"handleContextMenu",function(t,e){t.stopPropagation(),t.preventDefault();at({x:t.pageX,y:t.pageY,content:m.a.createElement(Z,{data:[{name:"编辑",onClick:function(){return n.handleEdit(e)}},{name:"设为输出",onClick:function(){return n.cell.out=e.id}},{name:"删除",onClick:function(){n.cell.body=n.cell.body.filter(function(t){if(t!==e)return t.input=t.input.filter(function(t){return t!==e.id}),!0}),n.forceUpdate()}}]})})}),R()(I()(I()(n)),"handleLinkContext",function(t,e,r){t.stopPropagation(),t.preventDefault();at({x:t.pageX,y:t.pageY,content:m.a.createElement(Z,{data:[{name:"删除",onClick:function(){e.removeInput(r),n.forceUpdate()}}]})})}),R()(I()(I()(n)),"publish",function(){G({title:"发布项目",content:'确定发布"'.concat(n.project.name,'"吗?'),onOk:function(){API.component.add({_id:n.props.match.params.id,name:n.project.name,desc:n.project.desc,config:n.cell.toJson()})}})}),R()(I()(I()(n)),"code",function(){var t=J.open({title:"Code",width:"80%",height:"80%",content:m.a.createElement("pre",{style:{height:"100%",overflow:"auto",userSelect:"text"}},JSON.stringify(n.cell.toJson(),void 0,2)),onOk:function(){t.close()}})}),R()(I()(I()(n)),"run",function(){if(n.interval)clearInterval(n.interval),n.refs.osc.style.bottom="-200px",n.interval=null;else{n.save(),window[nt.a]=0,n.cell.reset(),n.view=[];var t=n.cell.body.find(function(t){return"VIEW"===t.type}),e=[];t&&(n.refs.osc.style.bottom=0,e=t.input.map(function(t){return n.cell.body.find(function(e){return e.id===t})})),n.interval=setInterval(function(){window[nt.a]++,n.cell.output(),t&&(n.view=Q()(n.view).concat([t.output.apply(t,Q()(e))])),n.forceUpdate()},window.INTERVAL||1e3)}n.forceUpdate()}),R()(I()(I()(n)),"save",function(){API.project.update({_id:n.props.match.params.id},{$merge:{config:n.cell.toJson()}})}),R()(I()(I()(n)),"handleSaveComponent",function(){n.modalSaveComponent=new X({title:"保存为组件",content:[m.a.createElement($,{name:"name",required:!0,placeholder:"名称",style:{marginBottom:15}}),m.a.createElement($,{name:"desc",type:"textarea",placeholder:"简介"})],onOk:function(t){n.saveComponent(t)}})}),R()(I()(I()(n)),"saveComponent",function(t){var e,r=n.cell.toJson(),a=r.components[r.from],o=Object(P.b)();n.project.config={from:o,components:O()({},r.components,(e={},R()(e,r.from,O()({},a,{output:n.cell.out,name:t.name,desc:t.desc})),R()(e,o,{type:"COMPONENT",name:n.project.name,desc:n.project.desc,input:[],links:[]}),e))},n.cell=new nt.b(n.project.config),n.modalSaveComponent.close(),n.modalSaveComponent=null,n.forceUpdate()}),n.view=[],n}return h()(e,t),c()(e,[{key:"componentDidMount",value:function(){this.update()}},{key:"pathData",value:function(t,e){var n=t.x+25+20,r=t.x-25-20,a=t.y-25-20,o=t.y+25+20,i=e.x-25-20,c=e.y-25-20,u=e.y+25+20,l="M".concat(t.x," ").concat(t.y," ");return t.x+25<e.x-25?(i=n=(n+i)/2,l+="L".concat(n," ").concat(t.y," L").concat(n," ").concat(e.y," L").concat(i," ").concat(e.y," ")):(l+="L".concat(n," ").concat(t.y," "),o<c?l+="L".concat(n," ").concat(c," L").concat(i," ").concat(c," L").concat(i," ").concat(e.y," "):a>u?l+="L".concat(n," ").concat(u," L").concat(i," ").concat(u," L").concat(i," ").concat(e.y," "):t.y>e.y?l+="L".concat(n," ").concat(Math.max(u,o)," L").concat(Math.min(i,r)," ").concat(Math.max(u,o)," L").concat(Math.min(i,r)," ").concat(e.y," "):l+="L".concat(n," ").concat(Math.min(c,a)," L").concat(Math.min(i,r)," ").concat(Math.min(c,a)," L").concat(Math.min(i,r)," ").concat(e.y," ")),l+="L".concat(e.x," ").concat(e.y)}},{key:"render",value:function(){var t=this,e=this.project,n=this.cell,r=this.publicComponents,a=this.view;if(!e)return null;var o=Object.entries(e.config.components||{}).filter(function(t){return"COMPONENT"===t[1].type&&t[0]!==e.config.from});return m.a.createElement("div",{className:"project-detail"},m.a.createElement("nav",null,m.a.createElement("div",{className:"title"},m.a.createElement(v.NavLink,{to:"/project"},m.a.createElement("i",{className:"iconfont icon-home"}))," / ",e.name),m.a.createElement("div",{className:"tool-btns"},m.a.createElement(Y,{onClick:this.publish},"发布"),m.a.createElement(Y,{onClick:this.code},"Code"),m.a.createElement(Y,{onClick:this.run},this.interval?"停止":"运行"),m.a.createElement(Y,{onClick:this.save},"保存"),m.a.createElement(Y,{onClick:this.handleSaveComponent},"保存为组件"))),m.a.createElement("div",{className:"body"},m.a.createElement("div",{className:"sidebar"},m.a.createElement("div",null,m.a.createElement("h2",null,"基础组件"),et("FUNCTION",{})(m.a.createElement("div",{className:"brick-card infinity-hover"},"ƒ(x)")),et("VIEW",{})(m.a.createElement("div",{className:"brick-card infinity-hover"},"V(x)"))),m.a.createElement("div",null,m.a.createElement("h2",null,"项目组件"),o.map(function(t){var e=b()(t,2),n=e[0],r=e[1];return et("COMPONENT",{id:n})(m.a.createElement("div",{className:"brick-card infinity-hover"},r.name))})),m.a.createElement("div",null,m.a.createElement("h2",null,"公共组件"),r&&r.map(function(t){return et("COMPONENT",{})(m.a.createElement("div",{className:"brick-card infinity-hover"},t.name))}))),m.a.createElement("div",{className:"content",ref:"content"},tt(["FUNCTION","COMPONENT","VIEW"],{onDrop:this.handleDrop})(m.a.createElement("svg",null,m.a.createElement("g",{className:"lines",ref:"lines"},n.body.map(function(e){return m.a.createElement("g",{key:e.id},e.input.map(function(r,a){var o=n.body.find(function(t){return t.id===r});return m.a.createElement("g",{key:"".concat(e.id,"-").concat(r),className:"link-path",onContextMenu:function(n){return t.handleLinkContext(n,e,a)}},m.a.createElement("path",{className:"path-hidden",d:t.pathData(o,e)}),m.a.createElement("path",{className:"path-display",d:t.pathData(o,e)}))}))})),m.a.createElement("g",{className:"modules"},n.body.map(function(e){return m.a.createElement(ct,{key:e.id,module:e,onDrag:function(n,r){return t.handleDrag(e,n,r)},onDragEnd:function(n,r){return t.handleDragEnd(e)},onLink:t.handleLink,onEdit:function(){return t.handleEdit(e)},onContextMenu:function(n){return t.handleContextMenu(n,e)}})})))),m.a.createElement("div",{className:"view",ref:"osc"},m.a.createElement(lt,{data:a,xCount:100})))))}}]),e}(d.Component)),pt=function(t){function e(t){return o()(this,e),l()(this,p()(e).call(this,t))}return h()(e,t),c()(e,[{key:"render",value:function(){var t=this.props.match;return m.a.createElement("div",null,m.a.createElement(v.Switch,null,m.a.createElement(v.Route,{exact:!0,path:t.path,component:H}),m.a.createElement(v.Route,{path:"".concat(t.path,"/:id"),component:st})))}}]),e}(d.Component);n(47);window.API=r,window.log=function(){var t;window.DEBUG&&(t=console).log.apply(t,arguments)};var ft=function(t){function e(t){return o()(this,e),l()(this,p()(e).call(this,t))}return h()(e,t),c()(e,[{key:"render",value:function(){return m.a.createElement(v.HashRouter,null,m.a.createElement(v.Switch,null,m.a.createElement(v.Route,{exact:!0,path:"/",component:A}),m.a.createElement(v.Route,{path:"/project",component:pt}),m.a.createElement(v.Redirect,{to:"/"})))}}]),e}(d.Component);_.a.render(m.a.createElement(ft,null),document.getElementById("app"))}]);
//# sourceMappingURL=bundle.js.map